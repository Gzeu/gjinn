<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Gjinn - Your AI Genie for creative image generation with daily challenges">
    <meta name="theme-color" content="#4a148c">
    <title>Gjinn - Your AI Genie of Imagination</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="apple-touch-icon" href="/apple-touch-icon.png">
    <link rel="manifest" href="/site.webmanifest">
    
    <!-- Preload critical resources -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Styles -->
    <link rel="stylesheet" href="css/variables.css">
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/auth.css">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/gallery.css">
    
    <!-- PWA Support -->
    <link rel="manifest" href="manifest.json">
    
    <!-- Environment Variables (injected by GitHub Actions) -->
    <script>
        // These will be replaced by GitHub Actions with actual environment variables
        window.__ENV_VITE_SUPABASE_URL__ = '{{ VITE_SUPABASE_URL }}';
        window.__ENV_VITE_SUPABASE_ANON_KEY__ = '{{ VITE_SUPABASE_ANON_KEY }}';
        window.__ENV_VITE_POLLINATION_API_KEY__ = '{{ VITE_POLLINATION_API_KEY }}';
    </script>
    
    <!-- Supabase -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    
    <!-- Pollination SDK -->
    <script src="https://unpkg.com/@pollinations-ai/pollinations.js"></script>
    
    <!-- App Configuration -->
    <script src="js/config.js"></script>
    
    <!-- Supabase Integration -->
    <script src="js/supabase-integration.js"></script>
    
    <!-- Daily Prompts Module -->
    <script type="module">
        import { DailyPrompts } from './js/daily-prompts.js';
        window.DailyPrompts = DailyPrompts;
    </script>
    
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Gjinn">
</head>
<body>
    <!-- Magical background stars -->
    <div class="stars-container">
        <div class="stars"></div>
        <div class="stars2"></div>
        <div class="stars3"></div>
    </div>

    <!-- Magic particles -->
    <div class="magic-particles"></div>

    <!-- Header -->
    <header class="header">
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <div class="lamp-icon">üßû‚Äç‚ôÇÔ∏è</div>
                    <h1>Gjinn</h1>
                </div>
                <nav class="nav">
                    <a href="#home" class="nav-link active" data-section="home">Home</a>
                    <a href="#wishes" class="nav-link" data-section="wishes">My Wishes</a>
                    <a href="#gallery" class="nav-link" data-section="gallery">Gallery</a>
                    <a href="#settings" class="nav-link" data-section="settings">Settings</a>
                </nav>
                <div class="user-profile">
                    <button id="user-menu-button" class="user-menu-button" aria-haspopup="true" aria-expanded="false">
                        <span class="avatar" id="user-avatar">üë§</span>
                        <span class="username" id="user-display-name">Guest</span>
                        <svg class="dropdown-arrow" width="12" height="8" viewBox="0 0 12 8" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M1 1.5L6 6.5L11 1.5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </button>
                    <div id="user-menu" class="user-menu hidden">
                        <div id="signed-out-menu">
                            <button id="auth-signin" class="menu-item">
                                <svg class="menu-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M15 3H19C19.5304 3 20.0391 3.21071 20.4142 3.58579C20.7893 3.96086 21 4.46957 21 5V19C21 19.5304 20.7893 20.0391 20.4142 20.4142C20.0391 20.7893 19.5304 21 19 21H15M10 17L15 12M15 12L10 7M15 12H3" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                                Sign In
                            </button>
                            <button id="auth-signup" class="menu-item">
                                <svg class="menu-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M19 21V19C19 17.9391 18.5786 16.9217 17.8284 16.1716C17.0783 15.4214 16.0609 15 15 15H9C7.93913 15 6.92172 15.4214 6.17157 16.1716C5.42143 16.9217 5 17.9391 5 19V21M16 7C16 9.20914 14.2091 11 12 11C9.79086 11 8 9.20914 8 7C8 4.79086 9.79086 3 12 3C14.2091 3 16 4.79086 16 7Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                                Create Account
                            </button>
                        </div>
                        <div id="signed-in-menu" class="hidden">
                            <div class="menu-item-info">
                                <div class="user-email" id="user-email-display"></div>
                                <div class="user-stats" id="user-stats-display"></div>
                            </div>
                            <button id="auth-signout" class="menu-item">
                                <svg class="menu-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M9 21H5C4.46957 21 3.96086 20.7893 3.58579 20.4142C3.21071 20.0391 3 19.5304 3 19V5C3 4.46957 3.21071 3.96086 3.58579 3.58579C3.96086 3.21071 4.46957 3 5 3H9M16 17L21 12M21 12L16 7M21 12H9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                                Sign Out
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Auth Modal -->
                <div id="auth-modal" class="modal">
                    <div class="modal-backdrop"></div>
                    <div class="modal-content">
                        <button class="modal-close">&times;</button>
                        
                        <!-- Sign In Form -->
                        <div id="signin-form" class="auth-form active">
                            <h3>Welcome Back</h3>
                            <p class="auth-subtitle">Sign in to continue to Gjinn</p>
                            
                            <div class="auth-providers">
                                <button class="auth-provider-btn" id="signin-google">
                                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M21.8055 10.0415H21V10H12V14H17.6515C16.827 16.3285 14.6115 18 12 18C8.6865 18 6 15.3135 6 12C6 8.6865 8.6865 6 12 6C13.5295 6 14.921 6.577 15.9805 7.5195L18.809 4.691C17.023 3.0265 14.634 2 12 2C6.4775 2 2 6.4775 2 12C2 17.5225 6.4775 22 12 22C17.5225 22 22 17.5225 22 12C22 11.3295 21.931 9.674 21.8055 10.0415Z" fill="#FFC107"/>
                                        <path d="M3.15302 7.3455L6.43852 9.755C7.32752 7.554 9.48052 6 12 6C13.5295 6 14.921 6.577 15.9805 7.5195L18.809 4.691C17.023 3.0265 14.634 2 12 2C8.15902 2 4.82802 4.1685 3.15302 7.3455Z" fill="#FF3D00"/>
                                        <path d="M12 22C14.583 22 16.93 21.0115 18.7045 19.404L15.6095 16.785C14.6055 17.5455 13.3575 18 12 18C9.39902 18 7.19052 16.3415 6.35852 14.027L3.09753 16.5395C4.75253 19.778 8.11352 22 12 22Z" fill="#4CAF50"/>
                                        <path d="M21.8055 10.0415H21V10H12V14H17.6515C17.2571 15.1082 16.5467 16.0766 15.608 15.7855C15.6085 15.78 15.6095 15.78 15.6095 15.78L18.7045 18.399C18.4855 18.6015 22 16.5 22 12C22 11.3295 21.931 9.674 21.8055 10.0415Z" fill="#1976D2"/>
                                    </svg>
                                    Continue with Google
                                </button>
                                <button class="auth-provider-btn" id="signin-github">
                                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M12 2C6.477 2 2 6.477 2 12C2 16.418 4.865 20.166 8.84 21.49C9.34 21.58 9.52 21.27 9.52 21C9.52 20.77 9.51 20.14 9.51 19.31C6.73 19.91 6.14 17.97 6.14 17.97C5.68 16.81 5.03 16.5 5.03 16.5C4.12 15.88 5.1 15.9 5.1 15.9C6.1 15.97 6.63 16.93 6.63 16.93C7.5 18.45 8.97 18 9.54 17.76C9.63 17.11 9.89 16.67 10.17 16.42C7.95 16.17 5.62 15.31 5.62 11.5C5.62 10.39 6 9.5 6.65 8.79C6.55 8.54 6.2 7.5 6.75 6.15C6.75 6.15 7.59 5.88 9.5 7.17C10.29 6.95 11.15 6.84 12 6.84C12.85 6.84 13.71 6.95 14.5 7.17C16.41 5.88 17.25 6.15 17.25 6.15C17.8 7.5 17.45 8.54 17.35 8.79C18 9.5 18.38 10.39 18.38 11.5C18.38 15.32 16.04 16.16 13.81 16.41C14.17 16.72 14.5 17.33 14.5 18.26C14.5 19.6 14.49 20.68 14.49 21C14.49 21.27 14.67 21.59 15.19 21.49C19.14 20.16 22 16.42 22 12C22 6.477 17.523 2 12 2Z" fill="currentColor"/>
                                    </svg>
                                    Continue with GitHub
                                </button>
                            </div>
                            
                            <div class="auth-divider">
                                <span>or continue with email</span>
                            </div>
                            
                            <form id="signin-email" class="auth-form-email">
                                <div class="form-group">
                                    <label for="signin-email-input">Email</label>
                                    <input type="email" id="signin-email-input" required placeholder="you@example.com">
                                </div>
                                <div class="form-group">
                                    <div class="form-label-row">
                                        <label for="signin-password">Password</label>
                                        <a href="#" id="forgot-password" class="text-link">Forgot password?</a>
                                    </div>
                                    <input type="password" id="signin-password" required placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                                </div>
                                <button type="submit" class="btn btn-primary btn-block">Sign In</button>
                            </form>
                            
                            <p class="auth-switch">
                                Don't have an account? <a href="#" id="switch-to-signup">Sign up</a>
                            </p>
                        </div>
                        
                        <!-- Sign Up Form -->
                        <div id="signup-form" class="auth-form">
                            <h3>Create Account</h3>
                            <p class="auth-subtitle">Join Gjinn to save your creations</p>
                            
                            <form id="signup-email" class="auth-form-email">
                                <div class="form-group">
                                    <label for="signup-email-input">Email</label>
                                    <input type="email" id="signup-email-input" required placeholder="you@example.com">
                                </div>
                                <div class="form-group">
                                    <label for="signup-password">Password</label>
                                    <input type="password" id="signup-password" required minlength="6" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                                    <p class="input-hint">Minimum 6 characters</p>
                                </div>
                                <div class="form-group">
                                    <label for="signup-password-confirm">Confirm Password</label>
                                    <input type="password" id="signup-password-confirm" required minlength="6" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                                </div>
                                <button type="submit" class="btn btn-primary btn-block">Create Account</button>
                            </form>
                            
                            <p class="auth-switch">
                                Already have an account? <a href="#" id="switch-to-signin">Sign in</a>
                            </p>
                        </div>
                        
                        <!-- Forgot Password Form -->
                        <div id="forgot-password-form" class="auth-form">
                            <h3>Reset Password</h3>
                            <p class="auth-subtitle">Enter your email to receive a password reset link</p>
                            
                            <form id="reset-password-form">
                                <div class="form-group">
                                    <label for="reset-email">Email</label>
                                    <input type="email" id="reset-email" required placeholder="you@example.com">
                                </div>
                                <button type="submit" class="btn btn-primary btn-block">Send Reset Link</button>
                            </form>
                            
                            <p class="auth-switch">
                                Remember your password? <a href="#" id="switch-to-signin-from-forgot">Sign in</a>
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main">
        <div class="container">
            <!-- Home Section -->
            <section id="home" class="section active">
                <div class="hero">
                    <div class="hero-content">
                        <h2 class="hero-title">Unleash the Magic of Imagination</h2>
                        <p class="hero-subtitle">Your AI Genie is ready to grant your creative wishes</p>
                        
                        <!-- Daily Prompt will be injected here by JavaScript -->
                        
                        <div class="wish-maker">
                            <div class="input-container">
                                <input type="text" id="wish-input" class="wish-input" placeholder="What do you wish to create?" maxlength="200">
                                <div class="input-sparkles"></div>
                            </div>
                            
                            <div class="wish-buttons">
                                <button class="btn btn--magical" data-type="image">
                                    <span class="btn-icon">üñºÔ∏è</span>
                                    Generate Image
                                </button>
                                <button class="btn btn--magical" data-type="audio">
                                    <span class="btn-icon">üéµ</span>
                                    Create Sound
                                </button>
                                <button class="btn btn--magical" data-type="text">
                                    <span class="btn-icon">üìú</span>
                                    Write Story
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="hero-image">
                        <img src="https://user-gen-media-assets.s3.amazonaws.com/gemini_images/27899b18-3d8c-4646-b84a-465d821b20e5.png" alt="Mystical AI Genie" class="genie-image">
                    </div>
                </div>

                <!-- Active Wishes Panel -->
                <div class="wishes-panel">
                    <h3>My Active Wishes</h3>
                    <div class="wishes-grid" id="active-wishes">
                        <!-- Active wishes will be populated by JS -->
                    </div>
                </div>

                <!-- Completed Wishes Panel -->
                <div class="wishes-panel">
                    <h3>Recently Completed</h3>
                    <div class="wishes-grid" id="completed-wishes">
                        <!-- Completed wishes will be populated by JS -->
                    </div>
                </div>
            </section>

            <!-- My Wishes Section -->
            <section id="wishes" class="section">
                <div class="section-header">
                    <h2>My Wishes Dashboard</h2>
                    <p>Track and manage all your creative requests</p>
                </div>
                
                <div class="dashboard-stats">
                    <div class="stat-card">
                        <div class="stat-number" id="total-wishes">0</div>
                        <div class="stat-label">Total Wishes</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="completed-count">0</div>
                        <div class="stat-label">Completed</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="favorites-count">0</div>
                        <div class="stat-label">Favorites</div>
                    </div>
                </div>

                <div class="all-wishes" id="all-wishes-container">
                    <!-- All wishes will be populated by JS -->
                </div>
            </section>

            <!-- Gallery Section -->
            <section id="gallery" class="section">
                <div class="section-header">
                    <h2>Creative Gallery</h2>
                    <p>Explore your magical creations</p>
                </div>

                <div class="gallery-filters">
                    <button class="filter-btn active" data-filter="all">All</button>
                    <button class="filter-btn" data-filter="image">Images</button>
                    <button class="filter-btn" data-filter="audio">Audio</button>
                    <button class="filter-btn" data-filter="text">Stories</button>
                    <button class="filter-btn" data-filter="favorited">Favorites</button>
                    <button class="filter-btn" data-filter="public">Community</button>
                </div>

                <div class="gallery-grid" id="gallery-items">
                    <!-- Gallery items will be populated by JS -->
                </div>
            </section>

            <!-- Settings Section -->
            <section id="settings" class="section">
                <div class="section-header">
                    <h2>Magic Settings</h2>
                    <p>Customize your creative experience</p>
                </div>

                <div class="settings-content">
                    <div class="settings-card">
                        <h3>Generation Preferences</h3>
                        <div class="form-group">
                            <label class="form-label">Preferred Image Model</label>
                            <select class="form-control" id="image-model">
                                <option value="flux">Flux (Recommended)</option>
                                <option value="stable-diffusion">Stable Diffusion</option>
                                <option value="dall-e-3">DALL-E 3</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Default Image Size</label>
                            <select class="form-control" id="image-size">
                                <option value="1024x1024">1024x1024 (Square)</option>
                                <option value="1024x768">1024x768 (Landscape)</option>
                                <option value="768x1024">768x1024 (Portrait)</option>
                            </select>
                        </div>
                    </div>

                    <div class="settings-card">
                        <h3>Magical Interface</h3>
                        <div class="form-group">
                            <label class="form-label checkbox-label">
                                <input type="checkbox" id="particles-enabled" checked> 
                                <span class="checkbox-text">Enable Magic Particles</span>
                            </label>
                        </div>
                        <div class="form-group">
                            <label class="form-label checkbox-label">
                                <input type="checkbox" id="animations-enabled" checked> 
                                <span class="checkbox-text">Enable Animations</span>
                            </label>
                        </div>
                        <div class="form-group">
                            <label class="form-label checkbox-label">
                                <input type="checkbox" id="sound-effects" checked> 
                                <span class="checkbox-text">Sound Effects</span>
                            </label>
                        </div>
                        <div class="form-group">
                            <label class="form-label checkbox-label">
                                <input type="checkbox" id="daily-prompts-enabled" checked> 
                                <span class="checkbox-text">Show Daily Creative Challenges</span>
                            </label>
                        </div>
                    </div>

                    <div class="settings-card">
                        <h3>Account & Privacy</h3>
                        <div class="form-group">
                            <label class="form-label checkbox-label">
                                <input type="checkbox" id="auto-save" checked> 
                                <span class="checkbox-text">Auto-save creations to account</span>
                            </label>
                        </div>
                        <div class="form-group">
                            <label class="form-label checkbox-label">
                                <input type="checkbox" id="public-gallery"> 
                                <span class="checkbox-text">Share creations in community gallery</span>
                            </label>
                        </div>
                        <div class="form-group">
                            <label class="form-label checkbox-label">
                                <input type="checkbox" id="email-notifications"> 
                                <span class="checkbox-text">Email notifications for daily prompts</span>
                            </label>
                        </div>
                    </div>

                    <div class="settings-card features-card">
                        <h3>Feature Overview</h3>
                        <div class="features-chart-container">
                            <img src="https://ppl-ai-code-interpreter-files.s3.amazonaws.com/web/direct-files/9e90e47af1af939a01c6c84229c88a3e/9f02285d-7437-407a-ba84-895039df7dde/a039fc97.png" alt="Gjinn Features Chart" class="features-chart">
                        </div>
                        <p class="chart-description">Comprehensive overview of Gjinn AI's capabilities across Core Features, Creative Management, and User Experience.</p>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <!-- Success Modal -->
    <div id="success-modal" class="modal hidden">
        <div class="modal-backdrop"></div>
        <div class="modal-content">
            <div class="success-animation">‚ú®</div>
            <h3 id="success-title">Wish Granted!</h3>
            <p id="success-message">Your creative wish has been added to the queue</p>
            <button class="btn btn--primary" onclick="closeSuccessModal()">Wonderful!</button>
        </div>
    </div>

    <!-- Loading overlay -->
    <div id="loading-overlay" class="loading-overlay hidden">
        <div class="loading-spinner">
            <div class="genie-lamp">üßû‚Äç‚ôÇÔ∏è</div>
            <div class="loading-text">Granting your wish...</div>
            <div class="loading-progress">
                <div class="progress-bar">
                    <div class="progress-fill" id="loading-progress-fill"></div>
                </div>
                <div class="progress-text" id="loading-progress-text">0%</div>
            </div>
        </div>
    </div>

    <!-- Main App Script -->
    <script src="app.js"></script>
    
    <!-- Gallery Script -->
    <script src="js/gallery.js" type="module"></script>
</body>
</html>